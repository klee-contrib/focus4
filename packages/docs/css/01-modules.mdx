import {Meta} from "@storybook/blocks";

<Meta title="CSS/Modules CSS" />

# Modules CSS

Un [Module CSS](https://github.com/css-modules/css-modules) est un fichier CSS qui d√©finit du CSS de fa√ßon tout √† fait standard, mais qui devra √™tre import√© et r√©f√©renc√© explicitement dans le code.

Par exemple, le fichier CSS suivant qui d√©finit la classe CSS `element` :

```css
/* style.css */
.element {
    color: green;
}
```

devra √™tre import√© comme un module Javascript classique et r√©f√©renc√© explicitement dans un composant :

```tsx
// component.tsx
import css from "./style.css";

export function Component() {
    return <p className={css.element}>Hello</p>;
}
```

Le vrai nom de la classe `element` sera g√©n√©r√© au build, avec une convention de nommage qui garantira l'unicit√© du nom (en g√©n√©ral sous la forme `{nom du fichier}__{nom de la classe}__{hash du fichier}`), afin d'obtenir des classes CSS qui ne pourront jamais se confondre entre plusieurs fichiers (et donc plusieurs composants).

Le CSS de Focus est directement packag√© avec cette convention de nommage, et vous pouvez la reproduire dans votre projet pour vos fichiers CSS avec le plugin Vite de `@focus4/tooling` `cssAutoModules(regex)`

_Remarque : Vite par d√©faut ne traite que les fichiers en `.module.css` comme des modules CSS, le plugin de Focus permet de le faire pour tous les fichiers `.css` qui matchent la regex pass√©e en param√®tre._

## Typage des modules CSS

Pour garantir l'existence des classes CSS r√©f√©renc√©es dans le vode, Focus expose un outil pour g√©n√©rer les types Typescript correspondant aux classes CSS d'un fichier CSS. Il g√©n√®rera un fichier `*.css.d.ts` √† c√¥t√© de vos fichiers CSS qui permettra aux imports dans vos composants d'√™tre typ√©s correctement comme n'importe quel autre import Typescript.

Il se lance via la commande `npx focus4 cssgen`, souvent red√©finie en `npm run cssgen` dans votre `package.json` avec ces deux param√®tres :

-   `rootDir` (obligatoire), le r√©pertoire racine dans lequel chercher les fichiers CSS (souvent `.` ou `./src`)
-   `regex` (optionnel), une regex pour filtrer les fichiers CSS √† traiter. A priori, elle devrait √™tre √©gale √† celle de `cssAutoModules`.

Vous devriez donc en g√©n√©ral avoir un script `cssgen` dans votre `package.json` qui devrait ressembler √† `focus4 cssgen . __style__`.

Focus g√©n√®re ses types CSS avec √©galement, et vous pouvez r√©f√©rencer le CSS de Focus dans vos components en l'important si vous en avez besoin (ex : `import {popinCss} from "@focus4/layout`).

Les fichiers `.css.d.ts` g√©n√©r√©s peuvent para√Ætrent un peu √©tranges au premier abord...

```ts
// Extrait de table.css.d.ts du module `collections`.
import {CSSElement, CSSMod} from "@focus4/styling";

interface Header {
    _51308: void;
}
interface Heading {
    _66b1d: void;
}

export interface TableCss {
    header: CSSElement<Header>;
    "header--selected": CSSMod<"selected", Header>;
    heading: CSSElement<Heading>;
    "heading--sortable": CSSMod<"sortable", Heading>;
    "heading--sorted": CSSMod<"sorted", Heading>;
}

declare const tableCss: TableCss;
export default tableCss;
```

Mais ce format sera utile pour utiliser la fonction [`toBem`](/docs/css-tobem--docs#tobem-et-frombem) par la suite üòâ.
