import {Meta} from "@storybook/blocks";

<Meta title="Les bases/Libell√©s et ic√¥nes" />

# Libell√©s et ic√¥nes

Focus utilise [`i18next`](https://www.i18next.com/) pour g√©rer les libell√©s et les ic√¥nes utilis√©s √† travers ses diff√©rents composants. Vous √™tes largement encourag√©s √† l'utiliser pour vos propres libell√©s √©galement.

Focus utilise [`react-i18next`](https://react.i18next.com/) dans ses composants pour s'interfacer avec `i18next`, ce qui leur permet en particulier de se re-rendre automatiquement apr√®s un appel √† `i18next.changeLanguage()`. Vous pouvez librement utiliser directement la fonction `useTranslation` de `react-i18next`, un import direct depuis `i18next`, ou simplement rien du tout pour g√©rer les libell√©s dans vos applications.

En ce qui concerne les traductions de Focus, chaque module expose son propre objet de traduction, et la fonction `basei18nConfig` permet de simplifier leur initialisation.

Par exemple, en important les traductions de tous les modules :

```ts
import i18next from "i18next";
import {initReactI18next} from "react-i18next";

import {i18nCollections} from "@focus4/collections";
import {basei18nConfig} from "@focus4/core";
import {i18nFormToolbox} from "@focus4/form-toolbox";
import {i18nStores} from "@focus4/stores";
import {i18nLayout} from "@focus4/layout";

i18next.use(initReactI18next).init({
    ...basei18nConfig([i18nCollections, i18nFormToolbox, i18nLayout, i18nStores], {
        fr: {
            /* Vos traductions personnalis√©es en fran√ßais, qui peuvent surcharger celles de Focus. */
        },
        en: {
            /* Vos traductions personnalis√©es en anglais, qui peuvent surcharger celles de Focus. */
        }
    }),
    lng: "fr"
});
```

Cette fonction doit √™tre appel√©e √† l'initialisation de votre application, avant le chargement des vues.

Focus dispose de traductions par d√©faut en fran√ßais et en anglais, et vous pouvez en ajouter d'autres sur votre projet si besoin.

De plus, si vous voulez que la langue choisie dans `i18next` soit automatiquement envoy√©e au serveur dans toutes les requ√™tes via le header `Accept-Language`, vous pouvez renseigner l'option de configuration `coreConfig.useI18nextAcceptHeader` √† `true`. Par d√©faut, ce header est automatiquement renseign√© par le navigateur, et il existe des modules de `i18next` pour d√©tecter automatiquement la langue de l'utilisateur, donc vous pouvez aussi √©galement g√©rer le tout de mani√®re automatique üòâ.

## Surcharge de libell√©s

Chaque traduction utilis√©e dans un composant est r√©cup√©r√©e sous la forme `${i18nPrefix}.module.component.label`, ou `i18nPrefix` est une prop du composant qui vaut `"focus"` par d√©faut. Le fichier de traduction de Focus contient donc `focus.module.component.label`, et vous pouvez red√©finir cette traduction en renseignant `custom.module.component.label` dans l'initialisation d'i18n et `custom` comme valeur d'`i18nPrefix`.

Pour s'assurer de garder toutes les autres traductions par d√©faut, vous pouvez la d√©finir de cette fa√ßon :

```ts
i18next.init({
    lng: "fr",
    resources: {
        fr: {
            translation: {
                focus,
                custom: {
                    ...focus,
                    module: {...focus.module, component: {...focus.module.component, label: "Ma valeur custom"}}
                }
            }
        }
    }
});

// Ou bien utiliser `merge` de `es-toolkit` :
custom = merge(focus, {module: {component: {label: "Ma valeur custom"}}});
```

Vous pouvez bien s√ªr utiliser cette strat√©gie pour surcharger un libell√© de `focus` pour qu'elle s'applique dans toute l'application.

## Ic√¥nes

Les ic√¥nes sont √©galement d√©finies dans les traductions de Focus. Elle sont toutes dans l'objet `icons` qui est √† la racine de l'objet `focus` (ou la valeur de `i18nPrefix`). Par exemple `focus.icons.list.add` correspond √† l'ic√¥ne du bouton "Voir plus" des listes, tandis que le libell√© est dans `focus.list.show.more`.

Une ic√¥ne se d√©finit avec un **nom** et une **classe CSS**, qui permet de retrouver la police d'ic√¥nes associ√©e, et se pose avec le composant [`FontIcon`](/docs/composants-focus4‚àïtoolbox-fonticon--docs). La classe CSS est faculative car il existe une classe par d√©faut, d√©finie dans `uiConfig.defaultIconClassName` (et vaut `"material-symbols-outlined"`).

La cl√© i18n devra donc pointer vers un objet `{name, className?}` (avec `className` facultatif). Tout ce qui a √©t√© pr√©sent√© pour la surcharge de libell√© s'applique naturellement aussi pour les ic√¥nes.

_Remarque : la classe CSS de l'ic√¥ne peut √©galement √™tre un template du nom de l'ic√¥ne, par exemple `icon-{name}` pour avoir une classe `"icon-home"` pour `"home"`, ce qui est utile si la police d'ic√¥ne ne fonctionne pas directement avec le nom de l'ic√¥ne et qu'il faut une classe CSS d√©di√©e par ic√¥ne._

## Interpolations

Dans le cadre de la traduction des messages d'erreur, il est possible d'utiliser l'interpolation avec i18next, pour ins√©rer des valeurs dynamiques dans les messages. Pour cela, il suffit d'utiliser la syntaxe `{{variable}}` dans le message, o√π la variable est une cl√© de l'objet `$field` du champ concern√©. Par exemple, pour afficher le nom du champ dans le message d'erreur, on peut utiliser le message suivant : `Le champ {{label}} est obligatoire`. Si le label est une cl√© de traduction, pour le traduire √† l'int√©rieur du message d'erreur il faut utiliser la syntaxe `$t(variable)` dans le message, par exemple : `Le champ {{$t(label)}} est obligatoire`.
