import {Meta} from "@storybook/addon-docs/blocks";

<Meta title="Mod√®le m√©tier/Entit√©s et champs" />

# Entit√©s et champs

_Remarque : La mod√©lisation de Focus est enti√®rement disponible dans le module `@focus4/entities`, qui ne contient aucune d√©pendance aux autres modules de Focus. Vous pouvez donc librement r√©utiliser ce module et la mani√®re de d√©finir les entit√©s dans d'autres frameworks JS, peu importe qu'ils utilisent React ou non d'ailleurs._

## D√©finition d'une entit√©

Une entit√© se d√©finit via le builder d'entit√© `entity()`, qui peut contenir :

- Des champs (`e.field(domain)`), qui se d√©finit √† partir d'un **[domaine](/docs/mod√®le-m√©tier-domaines--docs)**. Son type Typescript est `FieldEntry`.
- Une autre **entit√©** (`e.object(Entity)`). Son type Typescript est `ObjectEntry`.
- Une liste d'une autre **entit√©** (`e.list(Entity)`). Son type Typescript est `ListEntry`.
- Une liste d'elle-m√™me (`e.recursiveList()`). Son type Typescript est `RecursiveListEntry`.

_Remarque : une entit√© ne peut pas se r√©f√©rencer elle-m√™me (en dehors de la liste r√©cursive), y compris via une r√©f√©rence dans une autre entit√© r√©f√©renc√©e._

Une d√©finition d'entit√© pourrait ressembler √† ceci par exemple :

```ts
const ProfilReadEntity = entity({
    id: e.field(DO_ID, f => f.optional().label("securite.profil.id")),
    libelle: e.field(DO_LIBELLE, f => f.label("securite.profil.libelle")),
    utilisateurs: e.list(UtilisateurItemEntity)
});
```

## Options de configuration communes

Les 4 m√©thodes de d√©finition d'entr√©e d'entit√© peuvent chacune prendre un builder qui permet de les configurer. Elles peuvent toute utiliser :

### `.optional()`

Par d√©faut, une entr√©e est obligatoire. Cette m√©thode permet de la rendre facultative.

### `.label()`

Pour renseigner un libell√© (de pr√©f√©rence une cl√© de traduction).

### `.comment()`

Pour renseigner un commentaire (de pr√©f√©rence une cl√© de traduction).

## Options de configuration pour les champs

En plus des options communes, les champs peuvent aussi d√©finir :

### `.type<T>()`

Permet de sp√©cialiser le type du champ au del√† du type induit par le sch√©ma de son domaine. Par exemple, pour un sch√©ma `ZodString`, le type pourrait √™tre sp√©cialis√© en `TypeUtilisateurCode`, un type du genre `"ADMIN" | "GEST" | "CONSULT"`.

### `.defaultValue(value)`

Permet de renseigner une valeur par d√©faut √† cette entit√© (lorsqu'elle sera utilis√©e plus tard dans un formulaire).

### `.name(name)`

Permet de d√©finir le nom du champ. La fonction `entity()` renseignera d√©j√† le nom du champ par le nom de la propri√©t√©, donc cette m√©thode ne serait utile qu'en dehors.

## G√©n√©ration des entit√©s

M√™me si la d√©finition d'une entit√© peut para√Ætre simple, il reste n√©anmoins recommander d utiliser un outil de mod√©lisation externe pour les g√©n√©rer, ne serait-ce que pour assurer la coh√©rence du mod√®le de donn√©es avec le serveur. Il parait que [TopModel](https://klee-contrib.github.io/topmodel) est un outil id√©al pour √ßa, et il dispose d'un [g√©n√©rateur](https://klee-contrib.github.io/topmodel/#/generator/js) d√©di√© pour ces entit√©s Focus üòâ.
